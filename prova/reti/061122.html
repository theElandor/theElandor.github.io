<!DOCTYPE html>
<head>
<title> Server DNS </title>
<meta name="viewport" content="width=device-width, initial-scale=1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="generator" content="Org-mode"><meta name="author" content="Matteo Lugli üêÉ">
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@5.2/distr/fira_code.css">
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
<style>
    .theme-light {
	--color-primary: black;
	--color-background: white;
	--color-text: black;
    }

    .theme-dark {
    
	--color-primary: #23b0ff;
	--color-background: #21202C;
	--color-text: white;
    }
    
    body {
	font-family: 'Fira Code', monospace;
	font-size: 20px;
	background-color: white;
    }

    div#menu {
	position: sticky;
	position: -webkit-sticky;
	top: 5px;
	z-index: 30;
    }

    div#menu button {
	right: 0px;
	position: absolute;
    }
    .src{
        background-color:white;
        color:black;
    }
    p {
	color: var(black);
    }

    h1,h3, h4, h5, a {
	color: var(black);
    }
    h2{
        color:#337ab7;
    }

    .title{
        text-decoration: underline;
        font-weight:bold;
    }

    nav a {
	color: var(black);
    }

    nav a:hover {
	color: var(black);
	text-decoration: none;
    }

    ul li, ol li {
	color: var(black);
    }

    .collapsible {
        background-color: white;
	border: none;
	text-align: left;
    }
    
    .top-buffer { margin-top: 18px; }

    figcaption { font-size: 15px; }

    footer { 
        text-align: center; 
        background-color: #FFFFEA;
    }

    .observation {
	border-style: solid;
	margin-top: 20px;
	margin-bottom: 20px;
    }

    pre {
	font-size: 20px;
	background-color: black;
	color: white;
	inline-size: 900px;
	overflow: auto;
	word-wrap: normal;
    }
    blockquote {
	border-left: 5px solid var(black);
        background-color: #ffffEA;
        font-size: 20px;
    }
    .MathJax_SVG_Display{
        color:black;
    }

    blockquote p {
	color: var(black);
    }

    /* side-menu stuff */
    .side-menu {
	position: fixed;
	left: 0;
	width: 60px;
	height: 100%;
	z-index: 100;
    }

    .side-menu-content {
	display: none;
	position: absolute;
	top: 60px;
	left: 0px;
	height: 100%;
	/* background-color: var(black); */
	z-index: 100;	
    }

    .side-menu-content ul {
	list-style-type: none;
	position: relative;
	margin-left: 5px;
	width: 100%;
	padding-left: 0px;
    }

    .side-menu-content ul li {
	position: relative;
	padding-top: 5px;
	font-size: 15px;
	padding-left: 0px;
    }

    .side-menu-content ul li a {
	color: var(black);
	text-decoration: none;
	font-weight: bold;
    }

    .toggle {
	position: absolute;
	display: block;
	top: 0;
	left: 0;
	width: 80px;
	height: 60px;
	background: var(white);
    }

    .toggle:hover {
	background: var(black);
    }

    .toggle:before {
	content: '\f0c9';
	font-family: fontAwesome;
	position: absolute;
	width: 100%;
	height: 100%;
	line-height: 60px;
	text-align: center;
	font-size: 24px;
	color: var(black);
    }

    @media (max-width: 1024px) {
	pre {
	    inline-size: 600px;
	}
    }

    @media (max-width: 576px) {
	* {
	    font-size: 10px;
	}

	h1 {
	    font-size: 13px;           
	}

	h2, h3, h4, h5 {
	    font-size: 12px;
	}

	blockquote {
	    font-size: 15px;
	}

	pre, li pre {
	    font-size: 10px;
	    color: white;
	    inline-size: 300px;
	    word-wrap: normal;
	    overflow: auto;
	}

        li pre {
	    inline-size: 250px;
        }

	.toggle {
	    width: 30px;
	}

	.toggle:before {
	    content: '\f0c9';
	    font-family: fontAwesome;
	    position: absolute;
	    width: 100%;
	    height: 100%;
	    line-height: 60px;
	    text-align: center;
	    font-size: 12px;
	    color: var(black);
	}	
    }


</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "center",
  displayIndent: "2em",
  messageStyle: "none",
  "HTML-CSS": {
    scale: 100,
    styles: {
      ".MathJax_Display": {
        "font-size": "100%"
      }
    }
  },
  "SVG": {
    scale: 100,
    styles: {
      ".MathJax_SVG_Display": {
        "font-size": "100%",
        "margin-left": "-2.281em"
      }
    }
  }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
</head>
<body>
<div id="content" class="container">

<div class="row top-buffer"> </div>

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><h1 class="title">Server DNS</h1>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->
<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><hr style="border: 1px solid #FFFFFF" />   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->
<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-" style="text-decoration: underline">  Info &triangledown;</h2>
</button><div class='sec- collapsible-content'>
<p>
Appunti della lezione in presenza del 06/12/22.
</p>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-" style="text-decoration: underline">  Introduzione &triangledown;</h2>
</button><div class='sec- collapsible-content'>
<p>
Sistema di naming dinamico e flessibile, che vuole rendere pi√π
semplice l'accesso a internet per gli utenti.
E' un sistema <b>distribuito geograficamente</b>.
</p>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-1" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-1" style="text-decoration: underline"> 1 Identificatori degli host &triangledown;</h2>
</button><div id="outline-container-sec-1-1" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-1-1" nil> 1.1 Hostname, l'idea &triangledown;</h3>
</button><div class='sec-1-1 collapsible-content'>
<p>
L'idea alla base del protocollo DNS √® quella di trasformare gli indirizzi IP in nomi comprensibili.
Serve quindi un sistema che possa <i>tradurre</i> i <b>nomi</b> in <b>indirizzi</b>.
Questi nomi prendono il nome di <b>hostname</b>, che sono essenzialmente
una serie di "label" (lunghe al pi√π 63 caratteri) separate da punti.
Inizalmente gli hostname potevano contenere soltanto caratteri alfanumerici, 
poi lo standard √® stato esteso nel tempo. Un hostname pu√≤ essere lungo
al pi√π <b>255 caratteri</b>.
</p>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-1-2" nil> 1.2 Hostname canonico &triangledown;</h3>
</button><div class='sec-1-2 collapsible-content'>
<p>
Un hostname √® detto <b>canonico</b> se ci permette di identificare univocamente un host all'interno di internet.
Si legge da destra verso sinistra per capire la <b>localizzazione</b> dell'host che ci interessa.

<div class="row top-buffer"> </div>
<img src="./dns1.png"class="img-responsive"style="display: block; margin-left: auto; margin-right: auto;">
<div class="row top-buffer"> </div>

</p>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-1-3" nil> 1.3 Vantaggi &triangledown;</h3>
</button><div class='sec-1-3 collapsible-content'>
<p>
Oltre all'usabilit√†, gli hostname forniscono anche altri vantaggi:
</p>
<ul class="org-ul">
<li><p>
il server pu√≤ essere spostato su un altro host;
</p>
</li>
<li><p>
il server pu√≤ usare pi√π di un host per erogare un servizio;
</p>
</li>
</ul>
<p>
<i>Infatti un singolo hostname pu√≤ corrispondere a diversi indirizzi IP!</i>
E' quindi utile per gestire il carico delle richieste, in contesti
distribuiti geograficamente.
Ovviamente si usano meccanismi di caching per non effettuare la 
risoluzione dell'indirizzo troppe volte.
</p>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-1-4" nil> 1.4 Meccanismi di naming &triangledown;</h3>
</button><div class='sec-1-4 collapsible-content'>
<p>
Due meccanismi fondamentali:
</p>
<ul class="org-ul">
<li><p>
<b>Lookup</b>: traduzione hostname \(\rightarrow\) indirizzo IP;
</p>
</li>
<li><p>
<b>Reverse Lookup</b>: traduzione indirizzo IP \(\rightarrow\) hostname;
</p>
</li>
<li><p>
<b>Name server</b> / <b>DNS server</b> : macchina che viene contatta
per effettuare una risoluzione diretta / inversa.
Non tutti i nameserver si occupano di tutti i nomi: esistono
dei meccanismi di <b>delega gerarchica</b>, che vediamo in seguito.
</p>
</li>
</ul>
<p>
Al giorno d'oggi si possono contattare i server DNS tramite
molti protocolli sicuri oltre ad UDP.
Ad esempio, viene usato UDP (protocollo "veloce") per effettuare
le query DNS di lookup, mentre viene usato TCP (protocollo "affidabile") per
gli aggiornamenti dei record dei name server.
Esistono diverse <i>regole sintattiche di naming</i>, √® importante ricordarsi
che i server DNS ragionano in logica <b>case insensitive</b>.
</p>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-1-5" nil> 1.5 Buisness &triangledown;</h3>
</button><div class='sec-1-5 collapsible-content'>
<p>
Il commercio di nomi pu√≤ avere costi molto elevati, e certe aziende 
traggono profitto dal registrare migliaia di nomi di attivit√† potenzialmente
di successo, che poi verranno ricattate per "comprare" il dominio corrispondente
al loro brand.
</p>
<ul class="org-ul">
<li><p>
<b>Cybersquatting</b> \(\rightarrow\) registrare un dominio che assomiglia o contiene
il brand di un'azienda e provare a rivenderlo.
Ora esistono molte policy per regolamentare queste operazioni fraudolente.
</p>
</li>
<li><p>
<b>Punycode</b> \(\rightarrow\) simboli che "assomigliano" a lettere o simboli
comunemente usati, sono praticamente indistinguibili ad occhio nudo.
Registrare siti con nomi contenenti punycode significa poter potenzialmente
indurre gli utenti finali a errori/typo che potrebero portare a frodi informatiche.
</p>
</li>
</ul>
</div>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-2" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-2" style="text-decoration: underline"> 2 Organizzazione logica &triangledown;</h2>
</button><div class='sec-2 collapsible-content'>
<p>

<div class="row top-buffer"> </div>
<img src="./dns2.png"class="img-responsive"style="display: block; margin-left: auto; margin-right: auto;">
<div class="row top-buffer"> </div>

</p>
</div>
<div id="outline-container-sec-2-1" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-2-1" nil> 2.1 TLD &triangledown;</h3>
</button><div class='sec-2-1 collapsible-content'>
<ul class="org-ul">
<li><p>
<b>gTLD</b>, (<i>generic</i>) legati allo scopo del sito. (.com .edu .org ...);
</p>
</li>
<li><p>
<b>ccTLD</b>, (<i>country code</i>) (.uk .it . fr ...)
</p>
</li>
<li><p>
<b>iTLD</b>, (<i>infrastructure</i>) si tratta di domini speciali che servono
per gestire informazioni tecniche sui sistemi DNS, ad esempio per le 
traduzioni inverse. (<b>.arpa</b>);
</p>
</li>
</ul>
<p>
Dal 2013 √® possibile usare qualsiasi tipo di parola in qualsiasi lingua
come TLD, incluse quelle non latine. Sul sito della IANA si possono
controllare quali sono i TLD attualmente attivi:
</p>
<ul class="org-ul">
<li><p>
<a href="http://data.iana.org/TLD/tlds-alpha-by-domain.txt">http://data.iana.org/TLD/tlds-alpha-by-domain.txt</a>
</p>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3"><button type="button" class="collapsible">
<h3 id="sec-2-2" nil> 2.2 SLD &triangledown;</h3>
</button><div class='sec-2-2 collapsible-content'>
<blockquote>
<p>
Gli <b>SLD</b> tipicamente corrispondono al vero brand dell'organizzazione/azienda.
</p>
</blockquote>
<p>
Come si pu√≤ intuire, si forma una <b>organizzazione gerarchica dei domini</b>, 
come quella in figura:

<div class="row top-buffer"> </div>
<img src="./dns3.png"class="img-responsive"style="display: block; margin-left: auto; margin-right: auto;">
<div class="row top-buffer"> </div>

Esiste quindi un "<b>root level</b>" nascosto, da cui si diramano le richieste
di risoluzione degli hostname.
</p>
</div>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-3" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-3" style="text-decoration: underline"> 3 Name server &triangledown;</h2>
</button><div class='sec-3 collapsible-content'>
<blockquote>
<p>
Il compito dei name server √® quello di tradurre gli URL dei siti web mettendoli
in relazione con gli indirizzi IP corrispondenti.
</p>
</blockquote>
<p>
Ad ogni livello della gerarchia dei domini corrisponde una <b>classe</b> di name server:
</p>
<ul class="org-ul">
<li><p>
<b>Root name server</b>;
Fino al 2004 esistevano <b>13</b> Root name server. In generale si segue il
principio della <b>ridondanza</b>, in modo da creare un sistema resiliente
(in caso di guasto, la traduzione degli hostname deve funzionare ugualmente).
</p>
</li>
<li><p>
<b>TLD name server</b>, che devono registrarsi presso i root name server.
</p>
</li>
<li><p>
<b>SLD name server</b>: se ad esempio <i>Unimore</i> volesse gestire dei sottodomini come
"www.ing.unimore.it", allora avrebbe bisogno di installare un SLD!
</p>
</li>
<li><p>
<b>Local name server</b>: server gestiti dagli ISP e dalle organizzazioni 
locali, corrispondono alle <i>foglie</i> dell'albero.
</p>
</li>
</ul>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-4" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-4" style="text-decoration: underline"> 4 Principio di delega &triangledown;</h2>
</button><div class='sec-4 collapsible-content'>
<blockquote>
<ul class="org-ul">
<li><p>
<b>Authoritative name server</b>: name server che ha il compito di fornire
corrispondenza tra tutti gli hostname del dominio ed i rispettivi indirizzi IP.
E' necessario per tutte le organizzazioni che gestiscono
un "nome a dominio".
</p>
</li>
</ul>
</blockquote>
<ul class="org-ul">
<li><p>
Esempio: name server gestito da Unimore responsabile degli hostname 
unimore.it
Tuttavia il singolo name-server principale di unimore potrebbe non
essere <b>direttamente</b> responsabile di tutti gli hostname che terminano
con "unimore.it", ma potrebbe "delegare" altri name-server.
Ad esempio, potrebbe delegare la risoluzione degli hostname "...dim.unimo.it"
al nodo indicato in rosso.
</p>
</li>
</ul>
<p>

<div class="row top-buffer"> </div>
<img src="./dns4.png"class="img-responsive"style="display: block; margin-left: auto; margin-right: auto;">
<div class="row top-buffer"> </div>

</p>
<blockquote>
<ul class="org-ul">
<li><p>
<b>Zona</b>: insieme di domini di cui √® <b>direttamente</b> responsabile un name-server.
</p>
</li>
</ul>
</blockquote>
<p>
I dati relativi ad una zona sono memorizzati all'interno di un <b>master file</b> 
presente sul <b>server primario</b>. Esistono anche dei <b>server secondari</b> che scaricano
dati relativi alla propria zona dal server primario. Come al solito si crea
ridondanza per avere una maggiore <i>resilienza</i> (almeno due server autoritativi per una zona devono
essere failure-indipendent). La frequenza di aggiornamento
dei dati nei server secondari √® tipicamente decisa dall'amministratore di rete.
</p>
<blockquote>
<ul class="org-ul">
<li><p>
<b>Zone transfer</b>: scambio di dati relativi alla zona di interesse tra il server primario e i secondari.
</p>
</li>
</ul>
</blockquote>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-5" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-5" style="text-decoration: underline"> 5 Dati del DNS &triangledown;</h2>
</button><div class='sec-5 collapsible-content'>
<p>
I Server DNS sono essenzialmente dei database che contengono
records. Ne esistono diversi tipi:
</p>
<ul class="org-ul">
<li><p>
<b>A</b> : canonical host name \(\rightarrow\) indirizzo IP. Potrebbero
essere presenti pi√π record per un singolo hostname.
</p>
</li>
<li><p>
<b>NS</b>: record che descrive il <b>name server autoritativo</b> per una
determinata zona.
</p>
</li>
<li><p>
<b>SOA</b>: zona \(\rightarrow\) parametri relativi;
</p>
</li>
<li><p>
<b>MX</b>: record relativo ad un server che gestisce le email per
un determinato dominio.
</p>
</li>
<li><p>
<b>CNAME</b>: canonical name --> alias. In pratica, un host pu√≤ avere 
diversi hostname, di cui solo uno canonico.
</p>
</li>
<li><p>
<b>PTR</b>: <i>Pointer to another node</i>.
</p>
</li>
<li><p>
<b>TXT</b>: campo relativo alle deleghe. E' un record del tipo:
protocollo --> server che gestisce quel protocollo.
</p>
</li>
<li><p>
<b>AAAA</b>: identico ad un record A, ma relativo ad IPv6.
</p>
</li>
</ul>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-6" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-6" style="text-decoration: underline"> 6 Tipi di query &triangledown;</h2>
</button><div class='sec-6 collapsible-content'>
<ul class="org-ul">
<li><p>
Query <b>ricorsiva</b>: il local name server gestisce tutte le ulteriori
query necessarie per ottenere l'indirizzo IP richiesto dal client.
</p>
</li>
<li><p>
Query <b>iterativa</b>: la risposta ricevuta dal client non √® direttamente
l'indirizzo IP del server richiesto, ma contiene informazioni utili
per la risoluzione completa del nome.
</p>
</li>
</ul>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-7" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-7" style="text-decoration: underline"> 7 Ulteriori definizioni &triangledown;</h2>
</button><div class='sec-7 collapsible-content'>
<ul class="org-ul">
<li><p>
<b>Domain name authority</b>: entit√† che gestisce i servizi
di root (<b>ICAAN</b>)
</p>
</li>
<li><p>
<b>Registration Authority</b>: entit√† che fornisce servizi di registrazione
per un TLD (Top Level Domain).
</p>
</li>
<li><p>
<b>Registar</b>: societ√† intermedia <i>autorizzata</i>;
</p>
</li>
</ul>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><div id="outline-container-sec-8" class="outline-2"><button type="button" class="collapsible">
<h2 id="sec-8" style="text-decoration: underline"> 8 Comandi &triangledown;</h2>
</button><div class='sec-8 collapsible-content'>
<p>
Si usa <b>whois</b> per ottenere informazioni su un particolare dominio.
Prende anche indirizzi IP come argomento, per ottenere i
metadati relativi.
</p>
<div class="org-src-container">

<pre class="src src-sh">whois unimore.it
whois 155.185.1.1
</pre>
</div>

<p>
Si usa <b>dig</b> se si vogliono gestire richieste DNS a basso livello.c
Vengono ritornati l'indirizzo IP e il nome canonico del server.
</p>
<pre class="example">
&gt;&gt;&gt; dig www.unimore.it

;; ANSWER SECTION:
www.unimore.it.		86400	IN	CNAME	www-2-122.gwa.unimo.it.
www-2-122.gwa.unimo.it.	7199	IN	A	155.185.2.122
</pre>

<p>
Per specificare un local name server diverso, si usa questo comando:
</p>
<pre class="example">
dig @8.8.8.8 www.unimore.it
</pre>

<p>
Per chiedere a chi √® delegata la gestione della posta, usare:
</p>
<pre class="example">
dig MX unimore.it
</pre>
</div>
</div>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->

<div class="row top-buffer"> </div>

<div class="row top-buffer"> </div>

<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><hr style="border: 1px solid #FFFFFF" />   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->
<div class="row">
   <div class="col-xs-1"></div>
   <div class="col-xs-10"><footer id="postamble">
<div>
<p class="author"><b>Author</b>: Matteo Lugli üêÉ</p><p class="email"><b>Email</b>: <a href="mailto:matteolugli18@gmail.com">matteolugli18@gmail.com</a></p><p class="date"><b>Created</b>: 2022-12-07 Wed 15:39</p>
</div>
</footer>
   </div>
   <div class="col-xs-1"></div>
</div> <!-- end row -->
<div class="row top-buffer"> </div>

<div class="row top-buffer"> </div>

<div class="row top-buffer"> </div>
<script>

      function set_sections() {
	// -- Deal with the hiding/showing of the various sections
	var buttons = document.getElementsByClassName('collapsible');

	for (var i = 0; i < buttons.length; i++) {
	  buttons[i].addEventListener('click', function() {
	    var content = this.parentElement;
	    divs = content.getElementsByTagName('div');
	    for (var j = 0; j < divs.length; j++) {
	      if (divs[j].style.display === '' || divs[j].style.display === 'block') {
		divs[j].style.display = 'none';
	      } else {
		divs[j].style.display = 'block';
	      }
	    }
	  });
	}
      }

      function hide_sections() {
	// -- Deal with the hiding/showing of the various sections
	var buttons = document.getElementsByClassName('collapsible');
	var sections_to_not_hide = ['Lecture Info', 'Overview', 'Basic Info', 'Informazioni Lezione', 'Table of Contents', 'Informazioni', 'Lecture Summary']

	for (var i = 0; i < buttons.length; i++) {
	  // -- Check which sections to hide initially
	  html_elem = buttons[i].getElementsByTagName('h2').length > 0 ?
	    buttons[i].getElementsByTagName('h2')[0] :
	    buttons[i].getElementsByTagName('h3').length > 0 ?
	    buttons[i].getElementsByTagName('h3')[0] :
	    buttons[i].getElementsByTagName('h4')[0];

	  var hide_section = true;

	  for (var h = 0; h < sections_to_not_hide.length; h++) {
	    if (html_elem.innerHTML.includes(sections_to_not_hide[h])) {
	      hide_section = false;
	    }
	  }

	  if (hide_section) {
	    divs = buttons[i].parentElement.getElementsByTagName('div');

	    for (var j = 0; j < divs.length; j++) {
	      divs[j].style.display =
		divs[j].style.display === '' || divs[j].style.display === 'block' ?
		divs[j].style.display = 'none' :
		divs[j].style.display = 'block';
	    }
	  }    
	}
      }

      // ---------------------------

      // function to set a given theme/color-scheme
      function setTheme(themeName) {
        localStorage.setItem('theme', themeName);
        document.documentElement.className = themeName;
      }

      // function to toggle between light and dark theme
      function toggleTheme() {
        if (localStorage.getItem('theme') === 'theme-dark') {
          setTheme('theme-light');
        } else {
          setTheme('theme-dark');
        }
      }

      // Immediately invoked function to set the theme on initial load
      (function () {
        if (localStorage.getItem('theme') === 'theme-light') {
          setTheme('theme-light');
        } else {
          setTheme('theme-dark');
        }
      })();
      

      // ---------------------------

      // toggle menu
      var menu_off = 1
      
      function toggleMenu() {
	let menu = document.querySelector('.side-menu');
	let menu_list = document.querySelector('.side-menu-content');
	let toggle = document.querySelector('.toggle');

	let inactive_color = getComputedStyle(document.body)
	    .getPropertyValue('--color-background');

	let active_color = getComputedStyle(document.body)
	    .getPropertyValue('--color-primary');	
		
	if (menu_off) {
	  // activate menu
	  toggle.style.backgroundColor = active_color;
	  menu.style.width = '170px';
	  menu_list.style.display = 'block';
	  menu_off = 0;
	} else {
	  // de-activate menu
	  toggle.style.backgroundColor = inactive_color;
	  menu.style.width = '60px';	  
	  menu_list.style.display = 'none';
	  menu_off = 1;
	}
      }

set_sections();
hide_sections();
</script>
</div>
</body>
</html>
